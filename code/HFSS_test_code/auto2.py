# ----------------------------------------------
# Script Recorded by Ansys Electronics Desktop Version 2023.1.1
# 18:39:31  Feb 02, 2024
# ----------------------------------------------
import ScriptEnv
ScriptEnv.Initialize("Ansoft.ElectronicsDesktop")
oDesktop.RestoreWindow()
oProject = oDesktop.SetActiveProject("InP_stack_EXAMPLE")
oDesign = oProject.SetActiveDesign("Inverse_Design")
oEditor = oDesign.SetActiveEditor("3D Modeler")
oEditor.ImportGDSII(
	[
		"NAME:options",
		"FileName:="		, "/home/local/ace/hy7593/Pixel_2layer_data/gds/TF2_sim=1.gds",
		"FlattenHierarchy:="	, True,
		"ImportMethod:="	, 1,
		[
			"NAME:LayerMap",
			[
				"NAME:LayerMapInfo",
				"LayerNum:="		, 20,
				"DestLayer:="		, "MET3",
				"layer_type:="		, "signal"
			],
			[
				"NAME:LayerMapInfo",
				"LayerNum:="		, 23,
				"DestLayer:="		, "MET4",
				"layer_type:="		, "signal"
			]
		],
		"OrderMap:="		, [			"entry:="		, [				"order:="		, 0,				"layer:="		, "MET3",				"LayerNumber:="		, 20,				"Thickness:="		, 1E-06,				"Elevation:="		, 5E-06,				"Color:="		, "red"],			"entry:="		, [				"order:="		, 1,				"layer:="		, "MET4",				"LayerNumber:="		, 23,				"Thickness:="		, 3E-06,				"Elevation:="		, 7E-06,				"Color:="		, "PINK"]]
	])
oEditor.ChangeProperty(
	[
		"NAME:AllTabs",
		[
			"NAME:Geometry3DAttributeTab",
			[
				"NAME:PropServers", 
                "MET4_10000",
				"MET4_153", 
				"MET3_95", 
				"MET3_88", 
				"MET4_184", 
				"MET3_17", 
				"MET3_90", 
				"MET3_2", 
				"MET4_179", 
				"MET4_180", 
				"MET3_89", 
				"MET3_105", 
				"MET4_176", 
				"MET3_134", 
				"MET3_10", 
				"MET3_51", 
				"MET4_150", 
				"MET3_106", 
				"MET4_189", 
				"MET3_96", 
				"MET4_203", 
				"MET3_41", 
				"MET3_19", 
				"MET4_213", 
				"MET3_97", 
				"MET3_117", 
				"MET4_282", 
				"MET4_283", 
				"MET4_284", 
				"MET3_56", 
				"MET4_158", 
				"MET3_156", 
				"MET3_144", 
				"MET4_216", 
				"MET3_110", 
				"MET4_222", 
				"MET3_150", 
				"MET4_218", 
				"MET3_152", 
				"MET3_78", 
				"MET3_154", 
				"MET3_98", 
				"MET4_156", 
				"MET4_159", 
				"MET3_66", 
				"MET3_138", 
				"MET3_92", 
				"MET3_155", 
				"MET4_195", 
				"MET3_29", 
				"MET3_104", 
				"MET3_68", 
				"MET3_80", 
				"MET4_190", 
				"MET3_35", 
				"MET3_42", 
				"MET3_44", 
				"MET3_13", 
				"MET3_39", 
				"MET3_120", 
				"MET3_129", 
				"MET4_162", 
				"MET4_210", 
				"MET3_12", 
				"MET4_178", 
				"MET3_24", 
				"MET3_116", 
				"MET3_11", 
				"MET3_131", 
				"MET4_245", 
				"MET4_246", 
				"MET4_247", 
				"MET4_248", 
				"MET4_166", 
				"MET4_232", 
				"MET3_59", 
				"MET4_194", 
				"MET3_6", 
				"MET4_217", 
				"MET4_249", 
				"MET4_250", 
				"MET4_251", 
				"MET3_27", 
				"MET4_187", 
				"MET4_212", 
				"MET4_155", 
				"MET3_16", 
				"MET3_32", 
				"MET4_206", 
				"MET3_151", 
				"MET3_135", 
				"MET4_154", 
				"MET4_160", 
				"MET3_14", 
				"MET4_200", 
				"MET4_186", 
				"MET4_167", 
				"MET3_130", 
				"MET3_153", 
				"MET4_175", 
				"MET4_169", 
				"MET4_204", 
				"MET3_143", 
				"MET3_43", 
				"MET4_296", 
				"MET4_297", 
				"MET4_298", 
				"MET4_299", 
				"MET3_122", 
				"MET4_267", 
				"MET4_268", 
				"MET3_23", 
				"MET3_87", 
				"MET4_161", 
				"MET4_269", 
				"MET3_34", 
				"MET3_86", 
				"MET3_147", 
				"MET3_132", 
				"MET4_173", 
				"MET3_64", 
				"MET4_304", 
				"MET4_305", 
				"MET4_306", 
				"MET3_99", 
				"MET3_65", 
				"MET4_220", 
				"MET3_7", 
				"MET4_157", 
				"MET4_242", 
				"MET4_243", 
				"MET4_244", 
				"MET3_37", 
				"MET3_40", 
				"MET3_126", 
				"MET4_226", 
				"MET3_22", 
				"MET3_146", 
				"MET4_191", 
				"MET3_70", 
				"MET3_15", 
				"MET3_140", 
				"MET3_94", 
				"MET3_149", 
				"MET3_33", 
				"MET3_159", 
				"MET3_160", 
				"MET3_20", 
				"MET4_225", 
				"MET3_75", 
				"MET4_183", 
				"MET3_158", 
				"MET4_260", 
				"MET4_261", 
				"MET4_262", 
				"MET3_76", 
				"MET3_114", 
				"MET4_219", 
				"MET3_57", 
				"MET4_181", 
				"MET4_278", 
				"MET4_279", 
				"MET4_280", 
				"MET4_281", 
				"MET3_125", 
				"MET4_231", 
				"MET3_163", 
				"MET4_197", 
				"MET3_148", 
				"MET4_234", 
				"MET4_202", 
				"MET4_263", 
				"MET4_264", 
				"MET4_265", 
				"MET4_266", 
				"MET4_152", 
				"MET3_127", 
				"MET4_211", 
				"MET4_196", 
				"MET3_21", 
				"MET4_149", 
				"MET4_285", 
				"MET4_286", 
				"MET4_287", 
				"MET4_288", 
				"MET3_67", 
				"MET3_47", 
				"MET3_161", 
				"MET4_198", 
				"MET3_77", 
				"MET3_45", 
				"MET3_145", 
				"MET3_93", 
				"MET4_192", 
				"MET4_270", 
				"MET4_271", 
				"MET4_272", 
				"MET4_273", 
				"MET4_303", 
				"MET4_185", 
				"MET3_137", 
				"MET4_300", 
				"MET4_301", 
				"MET4_302", 
				"MET4_252", 
				"MET4_253", 
				"MET4_254", 
				"MET4_255", 
				"MET4_256", 
				"MET4_257", 
				"MET4_258", 
				"MET4_259", 
				"MET4_201", 
				"MET3_48", 
				"MET4_193", 
				"MET3_81", 
				"MET3_63", 
				"MET4_229", 
				"MET4_241", 
				"MET4_205", 
				"MET3_69", 
				"MET3_36", 
				"MET4_274", 
				"MET4_275", 
				"MET4_276", 
				"MET4_277", 
				"MET3_5", 
				"MET3_109", 
				"MET3_53", 
				"MET3_74", 
				"MET4_240", 
				"MET3_113", 
				"MET3_100", 
				"MET3_102", 
				"MET4_223", 
				"MET4_214", 
				"MET4_208", 
				"MET3_107", 
				"MET3_157", 
				"MET3_73", 
				"MET3_49", 
				"MET4_164", 
				"MET3_136", 
				"MET3_3", 
				"MET3_141", 
				"MET4_224", 
				"MET3_133", 
				"MET3_164", 
				"MET4_307", 
				"MET4_221", 
				"MET3_30", 
				"MET3_119", 
				"MET3_128", 
				"MET3_83", 
				"MET3_71", 
				"MET4_292", 
				"MET4_293", 
				"MET4_294", 
				"MET4_295", 
				"MET3_18", 
				"MET4_215", 
				"MET4_168", 
				"MET3_124", 
				"MET3_31", 
				"MET4_289", 
				"MET4_290", 
				"MET4_291", 
				"MET3_52", 
				"MET4_233", 
				"MET4_199", 
				"MET3_8", 
				"MET3_60", 
				"MET4_188", 
				"MET4_165", 
				"MET4_230", 
				"MET3_26", 
				"MET3_162", 
				"MET3_62", 
				"MET4_209", 
				"MET4_207", 
				"MET3_101", 
				"MET4_151", 
				"MET3_9", 
				"MET3_108", 
				"MET4_172", 
				"MET3_79", 
				"MET3_46", 
				"MET3_72", 
				"MET3_121", 
				"MET3_84", 
				"MET4_182", 
				"MET4_163", 
				"MET3_91", 
				"MET3_38", 
				"MET3_123", 
				"MET3_103", 
				"MET3_50"
			],
			[
				"NAME:ChangedProps",
				[
					"NAME:Material",
					"Value:="		, "\"Au_InP\""
				]
			]
		]
	])
oProject.Save()
oDesign.AnalyzeAll()
